The core objective is to implement and evaluate a **Random Forest Regressor**, compare it with a Simple Linear Regression model, and assess performance using various regression metrics and visualizations.
- This project explores how well a machine learning model can predict calories burned based on the number of steps taken per day. 
- [Fitbase Dataset](https://www.kaggle.com/datasets/arashnic/fitbit) from Kaggle has been used. This dataset contains daily activity measures in 30 days tracked using a Fitbit smart watch among 33 users. 

## Project Workflow

### Data Preprocessing
- Cleaned the data by dropping rows with missing values in the relevant columns.
- Defined 'TotalSteps' as the input feature (X) and 'Calories' as the target variable (y).
- Split the data into training and testing sets using an 80/20 ratio.

### Model Development
1. Mean Baseline
2. Linear Regression
3. Random Forest

#### A. Baseline (Mean Predictor)
- Establish a baseline performance by calculating the *mean of the training target* (i.e. mean_calories) 
    - This serves as a *baseline* for minimum expected performance.
    - This ignores all input features (i.e. *'TotalSteps'*). It simply predicts the same value — the average (mean) of the *Calories* in the training data — for every single test sample.
    - If the advanced model (e.g., Random Forest) doesn't *perform better* than this simple mean predictor, then the complex model may not be useful.

#### B. Simple Linear Regression
- Built a simple *LinearRegression* model using the same training and testing data.
    - Used this model to benchmark the Random Forest results.

#### C. Random Forest Regressor
1. Initialized a *RandomForestRegressor* algorithm with basic hyperparameters (e.g., *n_estimators*=100, *random_state*=0).
2. Trained the model on the training data *(X_train)* and *(y_train)*.
3. Made predictions on the test set *(y_pred)*.
4. Employed *GridSearchCV* to tune Random Forest hyperparameters

### Model Evaluation
- Performance metrics to evaluate the model predictions:
    - Mean Squared Error (MSE) – Penalizes large errors.
    - Root Mean Squared Error (RMSE) – Brings error to original unit (calories).
    - Mean Absolute Error (MAE) – MAE gives average absolute error, easier to interpret than squared errors.
    - R² Score – R² indicates how well the model explains variance in the data (closer to 1 is better).

- The baseline MSE/RMSE indicates the error generated by predicting the average calories every time.
- Comparing the RandomForest model’s MSE/RMSE to Mean Baseline shows if RandomForest model is actually learning something useful.

### Hyperparameter Tuning
- Optimized model for lowest validation error (MSE) for better prediction performance.
- Employed *GridSearchCV* to tune Random Forest hyperparameters:
    - n_estimators
    - max_depth
    - min_samples_split
    - min_samples_leaf
    - max_features

### Visualization
A. Prediction Quality
- Scatter plot of Actual vs Predicted values with an identity line (y = x) to visualize prediction closeness.
- Residual Plot showing prediction errors to detect bias, variance, and patterns.

B. Model Performance
- Bar plots comparing MSE, RMSE, and MAE among the three models Mean Baseline, Linear Regression, Random Forest.

## Results

| Model                         | MSE        | RMSE   | MAE    | R² Score |
| ----------------------------- | ---------- | ------ | ------ | -------- |
| **Baseline (Mean Predictor)** | 502,923.03 | 709.17 | 564.79 | —        |
| **Simple Linear Regression**  | 348,941.22 | 590.71 | 471.19 | 0.305    |
| **Random Forest Regressor**   | 380,591.78 | 616.92 | 500.68 | 0.240    |

- Refer to bar graph comparison figures [MSE Comparison](ML_algorithms/Random_Forest/figures/mse_comparison.png), [RMSE Comparison](ML_algorithms/Random_Forest/figures/rmse_comparison.png) and [MAE Comparison](ML_algorithms/Random_Forest/figures/mae_comparison.png).

**1. Baseline Performance** (Mean Predictor)
- A naive model that predicts the mean calorie value for all samples.
- This sets the benchmark. Any model should ideally perform *better* than this.

**2. Simple Linear Regression:**
- This fits a straight line to capture the relationship between steps and calories burned. This shows that linear regression reduces error compared to the baseline. 
- It explains **~30.5%** of the variance in the target variable (y, calories), which indicates a **moderate** fit.
- But, ~70% of the variance is still unexplained.

**3. Random Forest Model Performance:**
- An ensemble of decision trees capturing non-linear relationships.
- Surprisingly, Random Forest performs *worse* than Linear Regression here: Higher MSE, RMSE, and MAE and lower R² score (24%) than Linear Regression.
- This suggests that the relationship between *total steps* and *calories* might not benefit from complexity, or the Random Forest may be **overfitting**, or not yet optimally tuned.

[Scatter Plot of Actual and Predicted](ML_algorithms/Random_Forest/figures/rf_lr.png)
displays the patterns in spread of data points. Clustering around the *prediction line* (Points close to the identity line (y = x)) indicates good predictions. Spread around the line indicated prediction error. 

[Residual Plot (Errors)](ML_algorithms/Random_Forest/figures/residual.png) 
displays a wider spread that indicates higher variance (potential overfitting or underfitting).

## Conclusion
- The complex models were much better at prediction than a simple baseline containing mean perdioctors.
- Although both random forest and simple linear regression models had a similar level of performance, Simple Linear Regression model currently performs **best**.
- From the RMSE values we can predict that about **600 calories** are burnt in a day.
- Next Steps:
    - Hyperparameter tuning for Random Forest (e.g., max_depth, min_samples_leaf)
    - Try other models: Gradient Boosting, XGBoost
    - Add predictors like: activity duration, TotalDistance.
    - Cross-validation for robust performance estimates.


[def]: ML_algorithms/Random_Forest/figures/rf_lr.png
[def2]: ML_algorithms/Random_Forest/figures/rf_lr.png
[def3]: ML_algorithms/Random_Forest/figures/rf_lr.png